name: Deploy-web-application-war-file

on:
  push:
    branches:
      - main

jobs:
	build:
		runs-on: ubuntu-latest
		steps:
			- name: Deploying-web-application-war-file:
			  uses: actions/checkout@v2

			- name: Make Backup of Code
			  run: |
				# Assuming your code is in a specific directory, create a backup
				mkdir backup
				cp -r path/to/your/code backup/

			- name: Install Maven
			  run: |
			  sudo apt-get install maven

			- name: Build WAR File	
			  run: |
			  cd path/to/your/code
			  mvn clean install
	
	move:
		runs-on: ubuntu-latest
		needs: build
		steps:
			- name: Move WAR File to EC2
			  run: |
			  # Replace with your EC2 instance details
			  scp path/to/your/code/target/your-app.war user@your_ec2_instance_ip:/path/on/ec2/

			- name: Restart Service on EC2
			  run: |
			  # Replace with your specific service restart command
			  ssh user@your_ec2_instance_ip "sudo systemctl restart your-service-name"

		
